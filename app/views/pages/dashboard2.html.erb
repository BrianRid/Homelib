<div id="dashboard" class="flat-image">
  <%= cl_image_tag  @rental.photos.fourth.key, class:"d-block img-fluid",width: 1800, height: 550, crop: :fill %>
</div>

<div class="container">
  <div class="row w-100">
    <div class="display-name d-flex col-6 mt-4">
      <h1> <span id="name-typed-text" data-user="<%= current_user.full_name %>"></span> </h1>
    </div>

    <div class="col-4 offset-8">

      <!-- card r√©sum√© appart -->
      <div id="appart2" class="mb-5">
        <% if @flat %>
        <div class="carac p-3">
          <h1><i class="far fa-building"></i>   Caract√©ristiques</h1>
          <p class="d-flex justify-content-left m-0"><i class="fas fa-location-arrow px-2"></i><%= @flat.address %></p>
          <p class="d-flex justify-content-left m-0"><i class="fas fa-home px-2"></i><%= @flat.nb_rooms %> chambres</p>
          <p class="d-flex justify-content-left m-0"><i class="fas fa-arrows-alt px-2"></"></i><%= @flat.area %>m2</p>
          <% if @flat.furnished? %>
          <p class="d-flex justify-content-left m-0"><i class="fas fa-couch px-2"></i>Meubl√© </p>
          <% end %>
        </div>
        <div class="carac p-3">
          <h1>Coordonn√©es du Syndic</h1>
          <p class="m-0"><i class="fas fa-phone px-2"> </i>  <%= @flat.syndic_phone %></p>
          <p class="m-0"><i class="fas fa-envelope-open-text px-2"></i>  <%= @flat.syndic_email %></p>
        </div>
        <% else %>
        Pas de location en cours
        <% end %>
      </div>
    </div>

  </div>

  <div class="row w-100">
    <div class="col-12">
      <!-- Partie basse des tuiles responsive -->
      <div class="container-incident">
        <h1>D√©clarer votre sinistre</h1>

        <%= simple_form_for Incident.new, html:{id:"dashboard_new_incident2"} do |f| %>
        <%= f.input :answer, label: false, collection: @first_decision[:answers], label_method: lambda{ |answer| render "incident_category_card", incident_category: answer.first }, as: :radio_buttons %>
        <%= f.submit "OK", class: "btn btn-primary d-none" %>
        <% end %>

      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-12">
      <div id="incident">
        <div class="incident-history">
          <h1>Historique d'incidents</h1>
          <div class="incident-content">
            <% @incidents.each do |incident| %>
            <%= link_to incident do  %>
            <div class="incident-line d-flex justify-content-between">
              <p> <%=incident.category.capitalize%> </p>
              <p> <%=incident.date.strftime("%d-%b-%y")%> </p>
              <%= render 'incidents/incident_status', incident: incident %>
              <p><%=  %></p>
              <p><%= incident.tarif %></p>
            </div>
            <% end %>
            <% end %>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div class="row w-100">
    <div class="col-6">
      <% if @rental %>
      <!-- card loyer -->
      <div class="loyers2 right-el mb-5">
        <div class="title">
          <h1>Mes Loyers</h1>
        </div>
        <div class="loyers-content">
          <% @last_rents.each do |rent| %>
          <div id="rent_<%= rent.id %>" class="rent-line">
            <div class="rent-date">
               <%= I18n.l(rent.date,  format: '%B', locale: :'fr').capitalize %>
            </div>
            <div class="rent-amount">
              <%= @rental.loyer %> ‚Ç¨
            </div>
            <div class="rent-status">
              <%= render 'rents/rent_status', rent: rent, rental: @rental %>
            </div>
          </div>
          <% end %>
        </div>
      </div>
      <% else %>
      <p>Pas de location en cours</p>
      <% end %>
    </div>

    <div class="col-6">
    <% if @rental %>
      <!-- card documents -->
      <div class="eds2 right-el d-flex flex-column ">
        <div class="title">
          <h1>Mes documents</h1>
        </div>
        <div class="document-content">
          <% current_user.documents.each do |doc| %>
          <div class="document-card">
            <div class="icone">
              <i class="fas fa-file-pdf"></i>
            </div>
            <div class="document-name">
              <p class="m-0 p-1"><%= doc.name %></p>
            </div>
            <div class="document-date">
              <p class="m-0 p-1"><%= doc.date %></p>
            </div>
            <div class="telechargement">
              <%= link_to("üì•", cl_image_path(doc.file.key), class: "download" ) %>
            </div>
            <div class="delete">
              <%= link_to "üóë", document_path(@documents[0]),  method: :delete, class: "destroy" %>
            </div>
          </div>
          <% end %>
        </div>
      </div>
      <%#= link_to "Ajouter un nouveau document", new_document_path, class: "btn btn-success w-100"  %>
       <button class="btn btn-success w-100" data-toggle="modal" data-target="#new_doc_modal">Ajouter un nouveau document</button>

      <% else %>
      <p>Pas de location en cours</p>
      <% end %>
    </div>
  </div>

  <!-- Carousel -->
  <div class="carousel-wrapper">
    <%= render 'carousel' %>
  </div>

</div>


<!-- Display error -->
<%= render 'incidents/errors', incident: @incident %>








<!-- modale Insert doc-->
        <div class="modal fade" id="new_doc_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Importer un document</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <div id="form" class="banner d-flex justify-content-center align-items-center" style="padding: 275px 0 ;background-image: linear-gradient(rgba(0,0,0,0.6),rgba(0,0,0,0.6)), url(https://images.unsplash.com/photo-1462899006636-339e08d1844e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80);">
                  <div class="d-flex justify-content-center" style="width:80%">
                    <div class="w-100 text-center">
                      <h3 class="text-light pb-4 ">Nouveau document</h3>
                        <div class="container d-flex justify-content-center">
                          <%= simple_form_for @document do |f| %>
                            <%= f.input :name, placeholder: 'Nom du document', label: false %>
                            <%= f.input :date , placeholder: 'Date du document', label: false, as: :string, required: false, input_html: {class: "datepicker bg-white"} %>
                            <%= f.input :file, label: 'Choisir un fichier', label_html: {class: "btn btn-primary m-0 w-100", id: 'file-pick'},:input_html => { :class => 'text-white d-none m-0'}%>
                            <div class="mb-4"><span id="file-upload-value" class="text-white"></span></div>
                            <%= f.submit "Valider", class: "btn btn-info ml-0 text-white w-100" %>
                          <% end %>
                        </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          <div class="modal-footer">
          </div>
        </div>
      </div>

